# Quick Context for Claude

**Project**: Virtual Client - Social work training with AI simulations  
**Current Phase**: 1.4 Part 7 - Section Statistics  
**Language**: Python 3.12 with FastAPI  
**Database**: SQLite with SQLAlchemy  
**Testing**: pytest  
**IDE**: PyCharm on Windows  

## 🎯 Current Task
Implementing section statistics endpoints for teachers to view enrollment counts and status.

**Key Files**:
- To Update: `backend/api/teacher_routes.py` (add stats endpoint)
- To Update: `backend/services/section_service.py` (add stats methods)
- To Create: `tests/integration/test_section_stats_api.py`
- Reference: `enrollment_service` for counting methods

## ⚡ Critical Patterns
- Statistics should include active/inactive enrollment counts
- Use SQL for efficient counting (avoid loading all records)
- Return zero counts for sections with no enrollments
- Include section metadata (name, teacher) with stats
- Consider caching for frequently accessed stats

## 🔑 Key Services Available
```python
# From enrollment_service
get_section_roster(db, section_id, include_inactive=False)  # Get enrollments

# From section_service  
get_teacher_sections(db, teacher_id)  # Get all teacher's sections
get(db, section_id)  # Get single section

# Need to add for stats:
# get_section_stats(db, section_id) -> enrollment counts
# get_all_sections_stats(db, teacher_id) -> bulk stats
```

## 📁 Project Structure
```
C:\Users\engbrech\Python\virtual_client\
├── backend/
│   ├── api/
│   │   ├── teacher_routes.py  # TO UPDATE: add stats endpoint
│   │   └── student_routes.py  # Completed in Part 6
│   ├── services/
│   │   ├── enrollment_service.py  # Has roster methods
│   │   └── section_service.py     # TO UPDATE: add stats methods
│   └── app.py  # No changes needed
└── tests/
    └── integration/
        └── test_section_stats_api.py  # TO CREATE
```

## 🚀 Quick Start Commands
```bash
# Start server
python start_server.py

# Run new tests (after creating)
python -m pytest tests/integration/test_section_stats_api.py -v

# Quick regression test
python test_quick.py
```

## 📋 Implementation Checklist
1. [ ] Add stats methods to section_service.py
2. [ ] Add GET /api/teacher/sections/stats endpoint
3. [ ] Add GET /api/teacher/sections/{id}/stats endpoint  
4. [ ] Write integration tests for stats endpoints
5. [ ] Ensure efficient SQL queries (no N+1)
6. [ ] Run all tests
7. [ ] Update documentation per COMPLETE_CHAT_PROMPT.md

---
*For detailed context see PROJECT_ROADMAP.md | For patterns see PATTERNS.md*